# Summary – Moniker Link (CVE-2024-21413)

**This module covered how specially crafted Outlook file:// moniker links can bypass Protected View, causing the client to attempt SMB authentication to an attacker host and leak netNTLMv2 hashes.**

- Learned the exploit concept: Outlook renders HTML and file:// monikers; adding ! + text to the moniker can bypass Protected View and trigger network auth.
- PoC approach: deliver an HTML email containing a file://...! moniker so the client attempts to resolve the resource and authenticate to the attacker.
- Attacker goal: capture the victim’s netNTLMv2 response from the SMB authentication handshake for relay or offline analysis.
- Detection methods: scan email content for file://...! monikers and correlate delivery times with outbound SMB/NTLM activity in network/host logs.
- Remediation: apply vendor Office/Outlook patches (Feb 2024); as interim controls, limit outbound SMB to untrusted hosts and reinforce user caution around unsolicited links.
- Best-practice lab workflow (theory): craft moniker → deliver to target → ensure listener available → trigger click → capture auth handshake → collect mail + network + host artifacts.
- Ethics: perform only in authorized lab environments; handle captured credentials and artifacts responsibly.
