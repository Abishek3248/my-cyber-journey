# Cheatsheet - Windows Event Logs

| Tool / Cmdlet | Purpose | Key Commands / Examples | Notes |
|---------------|---------|-----------------------|-------|
| **Event Viewer (GUI)** | Browse, filter, and analyze logs | Launch: `eventvwr.msc` | Left Pane: Log types (Windows Logs / Applications & Services Logs). Middle Pane: Event details. Right Pane: Actions (Filter, Custom View, Open Saved Log). |
| **wevtutil.exe** | Command-line log management | List logs: `wevtutil el` <br> Query events: `wevtutil qe Application /c:3 /rd:true /f:text` <br> Export log: `wevtutil epl Application App.evtx` <br> Clear log: `wevtutil cl Application` | Can be used remotely with `/r:REMOTEPC /u:USERNAME /p:PASSWORD`. Refer to `wevtutil /?` for full commands. |
| **Get-WinEvent (PowerShell)** | Query and filter event logs | List logs: `Get-WinEvent -ListLog *` <br> List providers: `Get-WinEvent -ListProvider *` <br> Filter by provider: `Get-WinEvent -LogName Application | Where-Object {$_.ProviderName -Match 'WLMS'}` <br> Filter with Hashtable: `Get-WinEvent -FilterHashtable @{LogName='Application'; ProviderName='WLMS'}` | Efficient filtering for large logs; can combine multiple sources. Supports XPath queries. |
| **XPath Queries** | Advanced filtering of XML event data | Event ID 100: `Get-WinEvent -LogName Application -FilterXPath '*/System/EventID=100'` <br> Provider: `Get-WinEvent -LogName Application -FilterXPath '*/System/Provider[@Name="WLMS"]'` <br> EventData (TargetUserName): `Get-WinEvent -LogName Security -FilterXPath '*/EventData/Data[@Name="TargetUserName"]="System"'` | Supports logical operators and attribute selection for precise filtering. |
| **Event Log Types** | Categorize events | **System:** OS, hardware, drivers <br> **Security:** Logon/logoff, audit events <br> **Application:** App errors/warnings <br> **Directory Service:** AD changes <br> **File Replication Service:** GPO/logon script changes <br> **DNS:** Domain events <br> **Custom Logs:** Application-specific | Logs reside in `C:\Windows\System32\winevt\Logs`. |
| **Key Event IDs (common)** | Security and monitoring | PowerShell logs: 4103, 4104 <br> Process Creation: 4688 <br> Log cleared: 1102 <br> New service: 7045 <br> Firewall change: 2006, 2033 | Enable features via Group Policy for certain logs (PowerShell logging, Audit Process Creation). |
| **Advanced Logging Features** | Enhance monitoring | PowerShell Logging: `Local Computer Policy > Computer Configuration > Administrative Templates > Windows Components > Windows PowerShell` <br> Audit Process Creation: `Local Computer Policy > Computer Configuration > Administrative Templates > System > Audit Process Creation` | Collects detailed info on script execution and command lines. |
| **Hands-On Scenarios** | Practice detection | Search logs for PowerShell usage, cleared logs, malware (Emotet), or suspicious commands (`C:\Windows\System32\net1.exe`) | Use `Get-WinEvent`, `wevtutil`, or Event Viewer to analyze events. |

